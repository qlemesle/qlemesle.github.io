<!doctype html>
<html lang="fr">
    <head>
        <meta charset="utf-8">
        <title>Titre de la page</title>
    </head>
        <body>
            <canvas id="myCanvas" width="500" height="200"></canvas>
        </br>
            <canvas id="myCanvas2" width="500" height="200"></canvas>
        </br>
            <canvas id="myCanvas3" width="500" height="200"></canvas>
        </body>
</html>
<script type="text/javascript">

    window.addEventListener('load', (event) => {
        let chrono = document.createElement("h1");
        let time = 10;
        chrono.innerHTML = time;

        let nIntervId;
        
        function changeChrono() {
            nIntervId = setInterval(flashChrono, 1000);
        }

        function flashChrono() {
            time = time - 1;
            if(time > -1){
                chrono.innerHTML = time;
            }else{
                chrono.innerHTML = "temps écoulé";
                stopChrono();
            }
        }
 
        function stopChrono() {
            clearInterval(nIntervId);
            console.log("chrono arrêté");
        }

        changeChrono();
        document.body.appendChild(chrono);

    /* ------------------------------------exercice 2------------------------------------------- */

        let canvas = document.getElementById('myCanvas');
        let ctx = canvas.getContext('2d');
        ctx.fillStyle = "red";
        let intervalSquare;
        
        function mouveSquare_to_right() {
            intervalSquare = setInterval(to_right_Square, 50);
        }
        function mouveSquare_to_left() {
            intervalSquare = setInterval(to_left_Square, 50);
        }

        let mvment = 0;
        
        function to_right_Square() {
            ctx.clearRect(10,10,mvment+100,mvment+100);
            ctx.fillRect(10+mvment, 10, 100, 100);
            mvment = mvment + 10;
            if(mvment >= (500-100)){
                stopSquare_r();
            }
        }

        function to_left_Square() {
            ctx.clearRect(10,10,mvment+100,mvment+100);
            ctx.fillRect(mvment - 10, 10, 100, 100);
            mvment = mvment - 10;
            if(mvment <= (10)){
                stopSquare_l();
            }
        }
 
        function stopSquare_r() {
            clearInterval(intervalSquare);
            mouveSquare_to_left();
        }
        function stopSquare_l() {
            clearInterval(intervalSquare);
            mouveSquare_to_right();
        }

        mouveSquare_to_right();

        /* ------------------------------------exercice 3------------------------------------------- */

        let canvas2 = document.getElementById('myCanvas2');
        let ctx2 = canvas2.getContext('2d');
        ctx2.fillStyle = "red";
        let intervalSquare2;
        
        function mouveSquare_to_right2() {
            intervalSquare2 = setInterval(to_right_Square2, 50);
        }
        function mouveSquare_to_left2() {
            intervalSquare2 = setInterval(to_left_Square2, 50);
        }

        let mvment2 = 0;
        
        function to_right_Square2() {
            ctx2.clearRect(10,10,mvment2+100,mvment2+100);
            ctx2.fillRect(10+mvment2, 10, 100, 100);
            mvment2 = mvment2 + 10;
            if(mvment2 >= (500-100)){
                stopSquare_r2();
            }
        }

        function to_left_Square2() {
            ctx2.clearRect(10,10,mvment2+100,mvment2+100);
            ctx2.fillRect(mvment2 - 10, 10, 100, 100);
            mvment2 = mvment2 - 10;
            if(mvment2 <= (10)){
                stopSquare_l2();
            }
        }
 
        function stopSquare_r2() {
            clearInterval(intervalSquare2);
            mouveSquare_to_left2();
        }
        function stopSquare_l2() {
            clearInterval(intervalSquare2);
            mouveSquare_to_right2();
        }

        /* ------------------------------------creation d'un compteur "TimerSecondes" pour lancer les carrés avec du délais------------------------------------------- */

        let timerSecondes = 0;
        let interTimer;

        function flashTimer() {
            timerSecondes ++;
            if(timerSecondes == 2){mouveSquare_to_right2();}

            if(timerSecondes == 1){bougeTonCube();}
            if(timerSecondes == 2){bougeTonCube();}
            if(timerSecondes == 3){bougeTonCube();}

            if(timerSecondes > 10){
                stopTimer();
            }
        }
 
        function stopTimer() {
            clearInterval(interTimer);
            console.log("timer arrêté");
        }

        interTimer = setInterval(flashTimer, 1000);

        /* ------------------------------------exercice 4------------------------------------------- */

        
        function bougeTonCube() {
            let canvas3 = document.getElementById('myCanvas3');
            let ctx3 = canvas3.getContext('2d');
            ctx3.fillStyle = "red";
            let intervalSquare3;

            function mouveSquare_to_right3() {
                intervalSquare3 = setInterval(to_right_Square3, 50);
            }

            let mvment3 = 0;
            
            function to_right_Square3() {
                ctx3.clearRect(mvment3,10,mvment3+100,mvment3+100);
                ctx3.fillRect(10+mvment3, 10, 100, 100);
                mvment3 = mvment3 + 10;
                if(mvment3 >= (500)){
                    stopSquare3();
                }
            }

            function stopSquare3() {
                ctx3.clearRect(10,10,mvment3+100,mvment3+100);
                clearInterval(intervalSquare3);
            }

            mouveSquare_to_right3();
        }
    });
    
</script>
